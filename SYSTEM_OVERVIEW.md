# JFinder - TÃ³m Táº¯t Há»‡ Thá»‘ng & Chá»©c NÄƒng

## ğŸ“Š KIáº¾N TRÃšC Tá»”NG THá»‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FRONTEND (Next.js)                          â”‚
â”‚                    http://localhost:3000                        â”‚
â”‚                                                                 â”‚
â”‚  Pages:                                                         â”‚
â”‚  â€¢ / (Home) - Landing page                                     â”‚
â”‚  â€¢ /search - TÃ¬m kiáº¿m máº·t báº±ng (Form + Grid Results)          â”‚
â”‚  â€¢ /map - Heatmap (Báº£n Ä‘á»“ nhiá»‡t vá»›i Leaflet)                  â”‚
â”‚  â€¢ /analysis - AI Analysis + ROI Calculator                    â”‚
â”‚  â€¢ /landlord - Äá»‹nh giÃ¡ cho chá»§ nhÃ  (AI Valuation)            â”‚
â”‚  â€¢ /dashboard - Dashboard thá»‘ng kÃª Next.js                     â”‚
â”‚  â€¢ /bi-dashboard - Apache Superset iframe                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP Requests
                         â”‚ /api/n8n/* (Next.js Proxy)
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            BACKEND API (n8n Automation)                         â”‚
â”‚                    http://localhost:5678                        â”‚
â”‚                                                                 â”‚
â”‚  Webhooks:                                                      â”‚
â”‚  â€¢ GET  /webhook/listings    - Danh sÃ¡ch máº·t báº±ng             â”‚
â”‚  â€¢ GET  /webhook/stats       - Thá»‘ng kÃª tá»•ng há»£p              â”‚
â”‚  â€¢ GET  /webhook/districts   - Danh sÃ¡ch quáº­n                 â”‚
â”‚  â€¢ POST /webhook/valuation   - AI Äá»‹nh giÃ¡                    â”‚
â”‚  â€¢ POST /webhook/roi         - ROI Calculator                 â”‚
â”‚                                                                 â”‚
â”‚  Data: In-memory (Generated by JS Code nodes)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BI DASHBOARD (Apache Superset)                         â”‚
â”‚                    http://localhost:8088                        â”‚
â”‚                                                                 â”‚
â”‚  Features:                                                      â”‚
â”‚  â€¢ SQL Lab - Write custom queries                              â”‚
â”‚  â€¢ Charts - Bar, Pie, Line, Heatmap, etc.                      â”‚
â”‚  â€¢ Dashboards - Drag & drop visualization                      â”‚
â”‚  â€¢ Data Sources: Google Sheets, CSV Upload                     â”‚
â”‚                                                                 â”‚
â”‚  Credentials: admin / admin                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… DANH SÃCH TÃNH NÄ‚NG (CHECKLIST)

### Frontend Pages (7 trang)

- [x] **Home** (`/`) - Landing page vá»›i gradient background
- [x] **TÃ¬m Kiáº¿m** (`/search`) - Form filter + Button "TÃ¬m Kiáº¿m Ngay" + Grid results
- [x] **Heatmap** (`/map`) - Báº£n Ä‘á»“ nhiá»‡t (Price/Potential mode) + Sidebar filters
- [x] **AI Analysis** (`/analysis`) - Form nháº­p thÃ´ng sá»‘ + AI Valuation card + ROI Calculator
- [x] **Landlord** (`/landlord`) - Äá»‹nh giÃ¡ cho chá»§ nhÃ  + Dashboard KPIs
- [x] **Dashboard** (`/dashboard`) - Thá»‘ng kÃª tá»« n8n API (Bar charts, Pie charts)
- [x] **BI Dashboard** (`/bi-dashboard`) - NhÃºng Apache Superset qua iframe

### Backend API (n8n) - 5 endpoints

- [x] `GET /webhook/listings` - Fetch danh sÃ¡ch (supports filters)
- [x] `GET /webhook/stats` - Thá»‘ng kÃª tá»•ng há»£p
- [x] `GET /webhook/districts` - Danh sÃ¡ch quáº­n + giÃ¡ TB
- [x] `POST /webhook/valuation` - AI Ä‘á»‹nh giÃ¡ máº·t báº±ng
- [x] `POST /webhook/roi` - TÃ­nh ROI vÃ  break-even

### Components

- [x] **Navbar** - Navigation menu vá»›i 7 items
- [x] **Footer** - Footer component
- [x] **RentalHeatmap** - Interactive map vá»›i CircleMarkers
- [x] **ValuationCard** - AI valuation display card

### Infrastructure

- [x] **Docker Compose** - n8n + Superset
- [x] **Next.js Proxy** - Giáº£i quyáº¿t CORS (`/api/n8n/*`)
- [x] **TypeScript** - Type-safe API helpers

### Scripts & Tools

- [x] **export_to_superset.py** - Export n8n data to CSV
- [x] **setup_superset.ps1** - Auto setup Superset

---

## ğŸ¯ CHá»¨C NÄ‚NG THÃ”NG MINH ÄÃƒ TRIá»‚N KHAI

| Chá»©c nÄƒng | Tráº¡ng thÃ¡i | CÃ´ng nghá»‡ | Ghi chÃº |
|-----------|------------|-----------|---------|
| **Geo-Intelligence (Heatmap)** | âœ… HoÃ n thiá»‡n | React Leaflet + n8n API | 2 modes: Price & Potential |
| **Smart Search** | âœ… HoÃ n thiá»‡n | n8n API + React State | Filter: district, type, price, area |
| **AI Valuation** | âœ… HoÃ n thiá»‡n | n8n Code Node (JS) | Formula-based pricing |
| **ROI Calculator** | âœ… HoÃ n thiá»‡n | n8n Code Node (JS) | Break-even calculation |
| **Real-time Stats** | âœ… HoÃ n thiá»‡n | n8n API | byDistrict, byType aggregation |
| **BI Dashboard** | âœ… HoÃ n thiá»‡n | Apache Superset | Custom charts & dashboards |

---

## ğŸ“¡ DATA FLOW

### 1. Luá»“ng dá»¯ liá»‡u Search
```
User Input (Form)
  â†’ Frontend state change
  â†’ Click "TÃ¬m Kiáº¿m Ngay"
  â†’ fetch('/api/n8n/listings?...')
  â†’ Next.js Proxy â†’ n8n :5678
  â†’ n8n Code Node generates data
  â†’ JSON Response
  â†’ Display in Grid Cards
```

### 2. Luá»“ng dá»¯ liá»‡u AI Valuation
```
User Input (district, area, frontage, floors, type)
  â†’ Click "Äá»‹nh GiÃ¡ Ngay"
  â†’ POST /api/n8n/valuation
  â†’ n8n receives body
  â†’ Code Node: price = f(district, area, frontage, floors, type)
  â†’ Returns { suggestedPrice, priceRange, potentialScore, ... }
  â†’ Display result dynamically
```

### 3. Luá»“ng dá»¯ liá»‡u Superset
```
n8n API (:5678)
  â†’ python export_to_superset.py
  â†’ CSV file (data/superset_listings.csv)
  â†’ Manual upload to Superset (:8088)
  â†’ Create Charts
  â†’ Create Dashboard
  â†’ Embed to /bi-dashboard (iframe)
```

---

## ğŸš€ HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG

### Cho NgÆ°á»i DÃ¹ng Cuá»‘i (Tenant)

1. VÃ o **TÃ¬m Kiáº¿m** (`/search`)
2. Chá»n Quáº­n, Loáº¡i hÃ¬nh, GiÃ¡ tá»‘i Ä‘a
3. Click **"TÃ¬m Kiáº¿m Ngay"**
4. Xem káº¿t quáº£ Grid
5. Click **"Xem trÃªn báº£n Ä‘á»“"** Ä‘á»ƒ chuyá»ƒn sang Heatmap
6. VÃ o **AI Analysis** Ä‘á»ƒ xem Ä‘á»‹nh giÃ¡ vÃ  tÃ­nh ROI

### Cho Chá»§ NhÃ  (Landlord)

1. VÃ o **Landlord** (`/landlord`)
2. Nháº­p thÃ´ng tin: Quáº­n, Diá»‡n tÃ­ch, Máº·t tiá»n, Sá»‘ táº§ng
3. Click **"Äá»‹nh GiÃ¡ Ngay"**
4. Xem khoáº£ng giÃ¡ gá»£i Ã½ tá»« AI

### Cho Admin (BI Analysis)

1. VÃ o **BI Dashboard** (`/bi-dashboard`)
2. Hoáº·c truy cáº­p trá»±c tiáº¿p Superset: `http://localhost:8088`
3. Táº¡o Charts, Dashboards tÃ¹y Ã½
4. NhÃºng vÃ o Next.js náº¿u cáº§n

---

## ğŸ”§ MAINTENANCE

### Update dá»¯ liá»‡u Superset
```bash
python scripts/export_to_superset.py
```

### Restart services
```bash
docker-compose restart
```

### View logs
```bash
docker-compose logs -f n8n
docker-compose logs -f superset
```

---

## ğŸ“ CREDENTIALS

| Service | URL | Username | Password |
|---------|-----|----------|----------|
| n8n | http://localhost:5678 | admin | admin |
| Superset | http://localhost:8088 | admin | admin |
| Frontend | http://localhost:3000 | - | - |

---

**Last updated**: 2026-01-13
**Version**: 2.0 (vá»›i Superset integration)
