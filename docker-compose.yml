version: '3.8'

services:
  # 1. BACKEND API: n8n Automation
  n8n:
    image: n8nio/n8n
    restart: always
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=false
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=admin
      - WEBHOOK_URL=http://localhost:5678/
      - NODE_FUNCTION_ALLOW_BUILTIN=*
      - NODE_FUNCTION_ALLOW_EXTERNAL=*
    volumes:
      - n8n_data:/home/node/.n8n
      - ./scripts:/scripts
      - ./app/data:/data

  # 2. BI DASHBOARD: Apache Superset
  superset:
    image: apache/superset
    restart: always
    ports:
      - "8088:8088"
    environment:
      - SUPERSET_SECRET_KEY=jfinder_super_secret_key_12345
    volumes:
      - superset_data:/app/superset_home

volumes:
  n8n_data:
  superset_data:
